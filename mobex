#!/bin/bash
clear
rm ~/x
echo -e "\e[32mInstalando paquetes necesarios\e[0m"
yes|pkg update && yes|pkg upgrade
sleep 2
echo -e "\e[32mInstalando paquetes necesarios\e[0m"
pkg install x11-repo -y &>/dev/null
echo -e "\e[32mPor favor espera ...\e[0m"
sleep 1
pkg install pulseaudio -y &>/dev/null
pkg install xwayland -y &>/dev/null
pkg install wget -y &>/dev/null
pkg install tsu -y &>/dev/null
pkg install root-repo -y &>/dev/null
pkg install patchelf -y &>/dev/null
pkg install p7zip -y &>/dev/null
pkg install xorg-xrandr -y &>/dev/null
pkg install ncurses-utils -y &>/dev/null
pkg install hashdeep -y &>/dev/null
pkg install termux-x11-nightly -y &>/dev/null

if [ -e $PREFIX/glibc ]; then
    echo -n "Si ya habias intentado instalar mobox escribe ( y ) "
    read i
    if [ "$i" = "Y" ] || [ "$i" = "y" ]; then
        rm -rf $PREFIX/glibc
    else
        return 1
    fi
fi

echo -e "\e[32mInstalando\e[0m \e[96mmobox\e[0m"
sleep 1
echo -e "\e[32mActualizando\e[0m \e[96mPaquetes Mobox\e[0m"
mkdir -p $PREFIX/glibc/opt/package-manager/installed
echo "PRIVATE_TOKEN=glpat-Xs4HfrCkMpbedkPycqzP
PROJECT_ID=52465323">$PREFIX/glibc/opt/package-manager/token
. $PREFIX/glibc/opt/package-manager/token
function wget-git-q {
    wget -q --retry-connrefused --tries=0 --header "PRIVATE-TOKEN: $PRIVATE_TOKEN" "https://gitlab.com/api/v4/projects/$PROJECT_ID/repository/files/$1/raw?ref=main" -O $2
    return $?
}
wget-git-q "package-manager" "$PREFIX/glibc/opt/package-manager/package-manager"
. $PREFIX/glibc/opt/package-manager/package-manager
sync-all
sync-package wine-ge-custom-8-25
ln -sf $PREFIX/glibc/opt/scripts/mobox $PREFIX/bin/mobox
sleep 1
echo -e "Para iniciar - escribe\e[92m \"mobox\"\e[0m"